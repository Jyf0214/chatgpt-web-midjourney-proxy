import{d as U,r as k,o as r,c as m,b as p,a4 as _,$ as d,J as i,ae as I,a as t,O as C,m as g,a$ as j,b0 as P,b1 as Z,l as q,X as W,S as K,G as $,Z as T,b2 as H,N as L,_ as S,b3 as A,aS as Q,b4 as G,ab as w,a2 as E,W as b,b5 as ee,I as N,a5 as te,Y as M,b6 as ae,a3 as se,a1 as le,b7 as X,b8 as oe}from"./index-b574640b.js";import{N as J}from"./Switch-a0db0e58.js";import{N as Y}from"./Slider-5fdb45e2.js";const ne={key:0,class:"cursor-pointer"},ie=U({__name:"mcUploadMp3",setup(z){const o=k(),l=k({process:"",id:"",isUpload:!1}),c=async v=>{for(let x=0;x<50;x++){let f=await j(`/uploads/audio/${v}`);g("ddd",f);let y=x+1;if(y>20&&(y=20),f.status=="complete"||f.status=="error")return f;await Z(y*1e3)}return null};async function a(v){try{l.value.isUpload=!0,g("uploadFile",v.target.files[0]);let f=v.target.files[0].name.split(".").pop();const y=await j("/uploads/audio",{extension:f||"mp3"});g("init ",y),l.value.id=y.id;const D=new FormData;for(let n in y.fields)D.append(n,y.fields[n]);if(D.append("file",v.target.files[0]),!(await fetch(y.url,{method:"POST",body:D})).ok)throw new Error("Network response was not ok");g("uploaded ");const s=await j("/uploads/audio/"+y.id+"/upload-finish",{upload_type:"file_upload",upload_filename:v.target.files[0].name});g("finish ",s);const e=await c(y.id);g("uploadFetch ",e);const h=await j("/uploads/audio/"+y.id+"/initialize-clip",{});g("clip ",h),P([h.clip_id])}catch{}l.value.isUpload=!1,o.value.value=""}return(v,x)=>(r(),m(C,null,[p(i(I),{type:"success",size:"small",round:""},{default:_(()=>[l.value.isUpload?(r(),m("span",ne,"Upload...")):(r(),m("span",{key:1,class:"cursor-pointer",onClick:x[0]||(x[0]=f=>o.value.click())},d(v.$t("suno.upMps")),1))]),_:1}),t("input",{type:"file",onChange:a,ref_key:"fsRef",ref:o,style:{display:"none"},accept:".mp3,audio/*,.m4a,.mp4"},null,544)],64))}}),ue={class:"p-2"},de={class:"pt-1"},re={class:"pt-4 flex justify-between"},pe={class:"pt-1"},ce={class:"pt-1"},ve={class:"pt-1"},me={class:"pt-4"},fe={class:"pt-4 flex justify-between"},_e={class:"pt-1"},ye={class:"pt-1"},xe={class:"pt-5"},he={class:"flex justify-between pb-3"},ge={class:"text-[12px]"},be={class:"bg-[--n-fill-color] text-[9px] border-[0px] px-1 list-none rounded-md"},$e={class:"pt-1"},ke={class:"flex relative justify-between items-start p-2 hover:dark:bg-black hover:bg-gray-200 border-b-[1px] border-gray-500/10"},we={class:"w-[60px] h-[60px] relative cursor-pointer"},De={class:"w-full h-full justify-center items-center flex"},je={class:"flex-1 pl-2"},Ce={class:"flex justify-between line-clamp-1 w-full cursor-pointer"},Ne={key:0,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer"},Ue={key:1,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer"},ze={class:"text-right text-[14px] flex justify-end items-center space-x-2"},Fe={key:0,class:"text-[8px] flex items-center border-[1px] border-red-500/80 px-1 list-none rounded-md"},Le={key:1,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},Se={key:2,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},Me={class:"pt-4"},Te={class:"flex justify-between items-start"},Ee={class:"space-x-1"},Ie=["innerHTML"],Pe=U({__name:"mcInput",setup(z){const o=k({type:"custom",isLoading:!1}),l=k(),c=k({gpt_description_prompt:"",make_instrumental:!1,mv:"chirp-v3-5",prompt:""}),a=k({prompt:"",mv:"chirp-v3-5",title:"",tags:"",continue_at:120,continue_clip_id:""}),v=[{label:"verion: v3.5",value:"chirp-v3-5"},{label:"verion: v3",value:"chirp-v3-0"}],x=q(()=>o.value.isLoading?!1:o.value.type=="custom"?a.value.tags&&a.value.title:o.value.type=="description"?(g("des: ",c.value.gpt_description_prompt,c.value.make_instrumental),a.value.title&&(c.value.gpt_description_prompt||c.value.make_instrumental)):!0),f=W();K(()=>{$.setMyData({ms:f})});const y=()=>{let u=a.value.prompt||a.value.title;if(!u){f.error(M("suno.inputly"));return}if(o.value.isLoading){f.info(M("suno.doingly"));return}o.value.isLoading=!0,f.info(M("suno.doingly2")),j("/generate/lyrics/",{prompt:u}).then(async s=>{g("lyrics",s);let e=await ae(s.id);g("lyrics rz =>",e),e!=null?(a.value.prompt=e.text,a.value.title=e.title):f.error(M("suno.lyricsFail")),o.value.isLoading=!1}).catch(()=>o.value.isLoading=!1),a.value.tags||(a.value.tags=G())},D=async()=>{var s,e;o.value.isLoading=!1;let u=["0d435185-d440-42c8-982a-50205e1cf17d","43e095ba-5f08-4920-bb3d-89dd0defe0b7"];if(u=["d359a0aa-adf1-4298-9074-005573d7cc84","12e3d62f-8fcc-497b-8365-194657582519"],o.value.type=="custom"){c.value.make_instrumental&&(a.value.prompt=""),a.value.continue_clip_id!=""&&((e=(s=l.value)==null?void 0:s.metadata)==null?void 0:e.type)=="upload"&&(a.value.mv="chirp-v3-5-upload");let h=await j("/generate",a.value);o.value.isLoading=!1,u=h.clips.map(n=>n.id),g("ids ",u),(a.value.mv="chirp-v3-5-upload")&&(a.value.mv="chirp-v3-5")}else{c.value.prompt=a.value.title;let h=await j("/generate/description-mode",c.value);o.value.isLoading=!1,u=h.clips.map(n=>n.id)}P(u)};return T(()=>$.myData.act,u=>{if(u=="suno.extend"){g("suno.extend",$.myData.actData);const s=$.myData.actData;l.value=s,a.value.continue_clip_id=s.id,a.value.continue_at=Math.ceil(s.metadata.duration/2)}}),(u,s)=>(r(),m("div",ue,[p(i(ee),{type:"segment",animated:"",value:o.value.type,"onUpdate:value":s[12]||(s[12]=e=>o.value.type=e)},{default:_(()=>[p(i(H),{name:"description",tab:u.$t("suno.description")},{default:_(()=>[t("div",de,[p(i(L),{placeholder:u.$t("suno.titlepls"),value:a.value.title,"onUpdate:value":s[0]||(s[0]=e=>a.value.title=e)},{prefix:_(()=>[t("span",null,d(u.$t("suno.title"))+"：",1)]),_:1},8,["placeholder","value"])]),t("div",re,[t("div",null,d(u.$t("suno.desc"))+":",1),t("div",null,[p(i(J),{value:c.value.make_instrumental,"onUpdate:value":s[1]||(s[1]=e=>c.value.make_instrumental=e),size:"small"},{checked:_(()=>[S(d(u.$t("suno.noneedly")),1)]),unchecked:_(()=>[S(d(u.$t("suno.noneedly")),1)]),_:1},8,["value"])])]),t("div",pe,[p(i(L),{value:c.value.gpt_description_prompt,"onUpdate:value":s[2]||(s[2]=e=>c.value.gpt_description_prompt=e),disabled:c.value.make_instrumental,placeholder:u.$t("suno.descpls"),type:"textarea",size:"small",autosize:{minRows:3,maxRows:12}},null,8,["value","disabled","placeholder"])]),t("div",ce,[p(i(A),{value:c.value.mv,"onUpdate:value":s[3]||(s[3]=e=>c.value.mv=e),options:v,size:"small"},null,8,["value"])])]),_:1},8,["tab"]),p(i(H),{name:"custom",tab:u.$t("suno.custom")},{default:_(()=>[t("div",ve,[p(i(L),{placeholder:u.$t("suno.titlepls"),value:a.value.title,"onUpdate:value":s[4]||(s[4]=e=>a.value.title=e)},{prefix:_(()=>[t("span",null,d(u.$t("suno.title"))+"：",1)]),_:1},8,["placeholder","value"])]),t("div",me,[p(i(L),{placeholder:u.$t("suno.stylepls"),value:a.value.tags,"onUpdate:value":s[6]||(s[6]=e=>a.value.tags=e)},{prefix:_(()=>[t("span",null,d(u.$t("suno.style"))+"：",1)]),suffix:_(()=>[p(i(Q),{placement:"right",trigger:"hover"},{trigger:_(()=>[t("div",{class:"cursor-pointer",onClick:s[5]||(s[5]=e=>a.value.tags=i(G)())},[p(i(w),{icon:"fa:random",class:"w-4 h-4"})])]),default:_(()=>[t("div",null,d(u.$t("suno.rank")),1)]),_:1})]),_:1},8,["placeholder","value"])]),t("div",fe,[t("div",null,d(u.$t("suno.ly"))+" :",1),t("div",null,[p(i(J),{value:c.value.make_instrumental,"onUpdate:value":s[7]||(s[7]=e=>c.value.make_instrumental=e),size:"small"},{checked:_(()=>[S(d(u.$t("suno.noneedly")),1)]),unchecked:_(()=>[S(d(u.$t("suno.noneedly")),1)]),_:1},8,["value"])])]),t("div",_e,[p(i(L),{value:a.value.prompt,"onUpdate:value":s[8]||(s[8]=e=>a.value.prompt=e),disabled:c.value.make_instrumental,placeholder:u.$t("suno.lypls"),type:"textarea",size:"small",autosize:{minRows:3,maxRows:12}},null,8,["value","disabled","placeholder"])]),t("div",ye,[p(i(A),{value:a.value.mv,"onUpdate:value":s[9]||(s[9]=e=>a.value.mv=e),options:v,size:"small"},null,8,["value"])]),a.value.continue_clip_id&&l.value?(r(),m(C,{key:0},[t("div",xe,[t("div",he,[t("div",ge,d(u.$t("suno.extendAt"))+" "+d(a.value.continue_at)+"s",1),p(i(I),{type:"success",size:"small",round:""},{default:_(()=>[t("span",{class:"cursor-pointer",onClick:s[10]||(s[10]=e=>a.value.continue_clip_id="")},"清除")]),_:1})]),p(i(Y),{value:a.value.continue_at,"onUpdate:value":s[11]||(s[11]=e=>a.value.continue_at=e),step:1,max:Math.ceil(l.value.metadata.duration)},{thumb:_(()=>[t("div",be,d(a.value.continue_at)+"s",1)]),_:1},8,["value","max"])]),t("div",$e,[t("div",ke,[t("div",we,[p(i(E),{lazy:"",width:"100",src:l.value.image_url,"preview-disabled":""},{placeholder:_(()=>[t("div",De,[p(i(w),{icon:"line-md:downloading-loop",class:"text-[40px] text-green-300"})])]),_:1},8,["src"])]),t("div",je,[t("div",Ce,[t("h3",null,d(l.value.title),1)]),l.value.metadata&&l.value.metadata.prompt?(r(),m("div",Ne,d(l.value.metadata.prompt),1)):(r(),m("div",Ue,d(u.$t("suno.noly")),1)),t("div",ze,[l.value.status=="error"?(r(),m("div",Fe,"失败")):b("",!0),l.value.metadata&&l.value.metadata.duration?(r(),m("div",Le,d(l.value.metadata.duration.toFixed(1))+"s",1)):b("",!0),l.value.major_model_version?(r(),m("div",Se,d(l.value.major_model_version),1)):b("",!0)])])])])],64)):b("",!0)]),_:1},8,["tab"])]),_:1},8,["value"]),t("div",Me,[t("div",Te,[t("div",Ee,[o.value.type=="custom"?(r(),N(i(I),{key:0,type:"success",size:"small",round:""},{default:_(()=>[t("span",{class:"cursor-pointer",onClick:s[13]||(s[13]=e=>y())},d(u.$t("suno.generately")),1)]),_:1})):b("",!0),o.value.type=="custom"?(r(),N(ie,{key:1})):b("",!0)]),p(i(te),{type:"primary",disabled:!i(x),onClick:s[14]||(s[14]=e=>D())},{default:_(()=>[p(i(w),{icon:"ri:music-fill"}),S(" "+d(u.$t("suno.generate")),1)]),_:1},8,["disabled"])])]),o.value.type=="custom"?(r(),m("div",{key:0,class:"pt-4 text-[12px]",innerHTML:i(M)("suno.info")},null,8,Ie)):b("",!0)]))}}),Re={class:"sss",style:{"--n-rail-height":"2px"}},Be=U({__name:"playui",emits:["update"],setup(z,{emit:o}){const l=k({v:10,max:0,status:"",idDrop:!1}),c=a=>{$.setMyData({act:"playUpdate",actData:{v:a}})};return T(()=>$.myData.act2,a=>{if(a=="playStatus"){if(l.value.idDrop)return;let v=$.myData.actData;g("playStatus",v),v&&v.d&&v.d.duration&&(l.value.max=v.d.duration,l.value.v=v.d.currentTime),v&&(l.value.status=v.a),o("update",l.value)}}),T(()=>$.myData.act,a=>{if(a=="playStatus"){let v=$.myData.actData;v&&(l.value.status=v.a),o("update",l.value)}}),(a,v)=>(r(),m("div",Re,[l.value.max?(r(),N(i(Y),{key:0,"on-dragend":()=>l.value.idDrop=!1,"on-dragstart":()=>l.value.idDrop=!0,class:"w-full",value:l.value.v,"onUpdate:value":v[0]||(v[0]=x=>l.value.v=x),step:1,max:l.value.max,"on-update:value":c,"format-tooltip":x=>x.toFixed(1)+"s"},null,8,["on-dragend","on-dragstart","value","max","format-tooltip"])):b("",!0)]))}});const Oe={key:0},Ve=["onClick"],He={class:"w-full h-full justify-center items-center flex"},Ae={key:0,class:"absolute top-0 right-0 w-full h-full flex justify-center items-center"},Ge={class:"absolute top-0 right-0 w-full h-full justify-center items-center flex"},Je={class:"flex-1 pl-2"},We=["onClick"],Xe={class:"flex justify-start items-center"},Ye={key:0,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 ml-1 list-none rounded-md"},Ze={class:"opacity-80 line-clamp-1 max-w-[320px]"},qe=["onClick"],Ke=["onClick"],Qe={class:"text-right text-[14px] flex justify-end items-center space-x-2"},et={key:0,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},tt={key:1,class:"text-[8px] flex items-center border-[1px] border-red-500/80 px-1 list-none rounded-md"},at={class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},st=["onClick"],lt={key:3,class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md"},ot=["href"],nt={key:1,class:"w-full h-full flex justify-center items-center"},it=U({__name:"mcList",setup(z){const o=k([]),l=new oe,c=k({playid:""}),a=W(),v=()=>{let e=l.getObjs();o.value=e.reverse()},x=e=>e.id==c.value.playid?["bg-gray-200","dark:bg-black"]:[],f=e=>{if(e.status=="error"){a.info("这首歌生成失败！");return}c.value.playid=e.id,$.setMyData({act:"goPlay",actData:e}),e.status!="complete"&&P([e.id])},y=e=>{g("extend",y),$.setMyData({act:"suno.extend",actData:e})},D=k({v:10,max:0,status:"",idDrop:!1});T(()=>$.myData.act,e=>{if(e=="FeedTask"&&v(),e=="playEned"){let h=o.value.findIndex(n=>n.id==c.value.playid);h++,g("playEned,",h,o.value.length),h<o.value.length&&setTimeout(()=>f(o.value[h]),1e3)}});const u=e=>{e=e.replace("m_","");let h=o.value.findIndex(n=>n.id==e);return h<0?null:o.value[h]},s=e=>{D.value=e};return v(),(e,h)=>o.value.length>0?(r(),m("div",Oe,[(r(!0),m(C,null,se(o.value,n=>{var R,B,O,V;return r(),m("div",{class:le([x(n),"flex relative justify-between items-start p-2 hover:dark:bg-black hover:bg-gray-200 border-b-[1px] border-gray-500/10"])},[c.value.playid==n.id?(r(),N(Be,{key:0,onUpdate:s,class:"absolute top-[-4px] left-0 w-full z-10"})):b("",!0),t("div",{class:"w-[60px] h-[60px] relative cursor-pointer",onClick:F=>f(n)},[n.status=="complete"?(r(),m(C,{key:0},[p(i(E),{lazy:"",width:"100",src:n.image_url,"preview-disabled":""},{placeholder:_(()=>[t("div",He,[p(i(w),{icon:"line-md:downloading-loop",class:"text-[40px] text-green-300"})])]),_:2},1032,["src"]),c.value.playid==n.id?(r(),m("div",Ae,[D.value.status=="pause"?(r(),N(i(w),{key:0,icon:"mdi:pause-circle-outline",class:"text-[40px] text-[#fff]"})):(r(),N(i(w),{key:1,icon:"mdi:play-circle-outline",class:"text-[40px] text-[#fff]"}))])):b("",!0)],64)):(r(),m(C,{key:1},[p(i(E),{lazy:"",width:"100",src:n.image_url,"preview-disabled":""},null,8,["src"]),t("div",Ge,[p(i(w),{icon:"line-md:downloading-loop",class:"text-[40px] text-green-300"})])],64))],8,Ve),t("div",Je,[t("div",{class:"flex justify-between line-clamp-1 w-full cursor-pointer",onClick:F=>f(n)},[t("div",Xe,[t("h3",null,d(n.title),1),((R=n.metadata)==null?void 0:R.type)=="upload"?(r(),m("div",Ye,"Uploaded")):b("",!0)]),t("div",Ze,d(n.metadata.tags),1)],8,We),n.metadata&&n.metadata.prompt?(r(),m("div",{key:0,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer",onClick:F=>f(n)},d(n.metadata.prompt),9,qe)):(r(),m("div",{key:1,class:"opacity-60 line-clamp-1 w-full text-[12px] cursor-pointer",onClick:F=>f(n)},d(e.$t("suno.noly")),9,Ke)),t("div",Qe,[(B=n.metadata)!=null&&B.audio_prompt_id?(r(),m("div",et,d(e.$t("suno.extendFrom"))+":"+d((V=u((O=n.metadata)==null?void 0:O.audio_prompt_id))==null?void 0:V.title),1)):b("",!0),n.status=="error"?(r(),m("div",tt,d(e.$t("suno.fail")),1)):b("",!0),n.metadata&&n.metadata.duration?(r(),m(C,{key:2},[t("div",at,d(n.metadata.duration.toFixed(1))+"s",1),t("div",{onClick:F=>y(n),class:"text-[8px] flex items-center border-[1px] border-gray-500/30 px-1 list-none rounded-md cursor-pointer"},d(e.$t("suno.extend")),9,st)],64)):b("",!0),n.major_model_version?(r(),m("div",lt,d(n.major_model_version),1)):b("",!0),p(i(w),{icon:"mdi:play-circle-outline",class:"cursor-pointer",onClick:F=>f(n)},null,8,["onClick"]),t("a",{href:n.audio_url,download:"",target:"_blank"},[p(i(w),{icon:"mdi:download",class:"cursor-pointer"})],8,ot)])])],2)}),256))])):(r(),m("div",nt,[p(i(X),{description:e.$t("suno.nodata")},null,8,["description"])]))}}),ut={key:0},dt={class:"w-full relative h-[300px]"},rt={class:"w-full h-full justify-center items-center flex"},pt={class:"absolute bottom-0 right-0 p-2 text-white text-right"},ct={class:"text-xl"},vt={class:""},mt={class:"text-wrap p-2"},ft={key:1,class:"flex w-full h-full justify-center items-center"},_t=U({__name:"mcplayer",setup(z){const o=k();return T(()=>$.myData.act,l=>{if(l=="goPlay"){let c=$.myData.actData;o.value=c}}),(l,c)=>o.value?(r(),m("div",ut,[t("div",dt,[p(i(E),{src:o.value.image_large_url,class:"w-full h-full"},{placeholder:_(()=>[t("div",rt,[p(i(w),{icon:"line-md:downloading-loop",class:"text-[60px] text-green-300"})])]),_:1},8,["src"]),t("div",pt,[t("h2",ct,d(o.value.title),1),t("div",vt,d(l.$t("suno.style"))+"："+d(o.value.metadata.tags),1)])]),t("pre",mt,d(o.value.metadata.prompt),1)])):(r(),m("div",ft,[p(i(X),{description:l.$t("suno.emputy")},null,8,["description"])]))}}),yt={class:"flex w-full h-full"},xt={class:"w-[300px] h-full overflow-y-auto"},ht={class:"flex-1 h-full bg-[#fafbfc] pt-2 dark:bg-[#18181c] overflow-y-auto"},gt={class:"w-[300px] h-full overflow-y-auto"},wt=U({__name:"music",setup(z){return(o,l)=>(r(),m("div",yt,[t("div",xt,[p(Pe)]),t("div",ht,[p(it)]),t("div",gt,[p(_t)])]))}});export{wt as default};
